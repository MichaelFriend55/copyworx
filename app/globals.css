/**
 * @file globals.css
 * @description Global styles and CSS custom properties for CopyWorx
 * 
 * Design System:
 * - Uses CSS custom properties for theming
 * - Ink/navy primary palette with amber accents
 * - Optimized for readability (writing tool aesthetic)
 */

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Background & Foreground */
    --background: 40 33% 99%;
    --foreground: 222 47% 11%;
    
    /* Card surfaces */
    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;
    
    /* Popover surfaces */
    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;
    
    /* Primary - Deep Ink Navy */
    --primary: 222 47% 16%;
    --primary-foreground: 40 33% 99%;
    
    /* Secondary - Warm Gray */
    --secondary: 220 14% 96%;
    --secondary-foreground: 222 47% 16%;
    
    /* Muted elements */
    --muted: 220 14% 96%;
    --muted-foreground: 220 8% 46%;
    
    /* Accent - Warm Yellow */
    --accent: 48 97% 48%;
    --accent-foreground: 222 47% 11%;
    
    /* Destructive actions */
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;
    
    /* Borders & Inputs */
    --border: 220 13% 91%;
    --input: 220 13% 91%;
    --ring: 48 97% 48%;
    
    /* Border Radius */
    --radius: 0.625rem;
  }

  .dark {
    /* Dark mode - Ink aesthetic */
    --background: 222 47% 8%;
    --foreground: 40 33% 98%;
    
    --card: 222 47% 11%;
    --card-foreground: 40 33% 98%;
    
    --popover: 222 47% 11%;
    --popover-foreground: 40 33% 98%;
    
    --primary: 48 97% 48%;
    --primary-foreground: 222 47% 8%;
    
    --secondary: 222 30% 18%;
    --secondary-foreground: 40 33% 98%;
    
    --muted: 222 30% 18%;
    --muted-foreground: 220 14% 60%;
    
    --accent: 48 97% 48%;
    --accent-foreground: 222 47% 8%;
    
    --destructive: 0 62% 50%;
    --destructive-foreground: 0 0% 98%;
    
    --border: 222 30% 22%;
    --input: 222 30% 22%;
    --ring: 48 97% 48%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  
  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Enhanced typography for writing tool - Inter font for all headings */
  h1, h2, h3, h4, h5, h6 {
    @apply font-sans tracking-tight;
  }

  /* Selection styling */
  ::selection {
    @apply bg-amber-200 text-ink-900;
  }

  ::-moz-selection {
    @apply bg-amber-200 text-ink-900;
  }

  /* Focus styling */
  :focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2 ring-offset-background;
  }
}

@layer components {
  /* Gradient text utility */
  .text-gradient {
    @apply bg-clip-text text-transparent bg-gradient-to-r from-ink-900 via-ink-700 to-ink-900;
  }

  .text-gradient-amber {
    @apply bg-clip-text text-transparent bg-gradient-to-r from-amber-500 via-amber-400 to-amber-500;
  }

  /* Glass morphism effect */
  .glass {
    @apply bg-white/70 backdrop-blur-lg border border-white/20;
  }

  .glass-dark {
    @apply bg-ink-900/70 backdrop-blur-lg border border-ink-700/20;
  }

  /* Subtle grid background */
  .bg-grid {
    background-image: 
      linear-gradient(to right, hsl(220 13% 91% / 0.5) 1px, transparent 1px),
      linear-gradient(to bottom, hsl(220 13% 91% / 0.5) 1px, transparent 1px);
    background-size: 24px 24px;
  }

  .bg-grid-dark {
    background-image: 
      linear-gradient(to right, hsl(222 30% 22% / 0.5) 1px, transparent 1px),
      linear-gradient(to bottom, hsl(222 30% 22% / 0.5) 1px, transparent 1px);
    background-size: 24px 24px;
  }

  /* Dot pattern background */
  .bg-dots {
    background-image: radial-gradient(hsl(220 13% 91%) 1px, transparent 1px);
    background-size: 20px 20px;
  }

  /* Animated underline for links */
  .link-underline {
    @apply relative;
  }

  .link-underline::after {
    @apply absolute left-0 bottom-0 w-0 h-0.5 bg-amber-500 transition-all duration-300;
    content: '';
  }

  .link-underline:hover::after {
    @apply w-full;
  }

  /* Card hover effect */
  .card-hover {
    @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1;
  }

  /* Glow effect for CTAs */
  .glow-amber {
    box-shadow: 0 0 40px -10px hsl(48 97% 48% / 0.5);
  }

  .glow-ink {
    box-shadow: 0 0 40px -10px hsl(222 47% 16% / 0.5);
  }
}

@layer utilities {
  /* Staggered animation delays */
  .animation-delay-100 { animation-delay: 100ms; }
  .animation-delay-200 { animation-delay: 200ms; }
  .animation-delay-300 { animation-delay: 300ms; }
  .animation-delay-400 { animation-delay: 400ms; }
  .animation-delay-500 { animation-delay: 500ms; }
  .animation-delay-600 { animation-delay: 600ms; }
  .animation-delay-700 { animation-delay: 700ms; }
  .animation-delay-800 { animation-delay: 800ms; }

  /* Hide scrollbar */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  /* Custom scrollbar */
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    @apply bg-muted rounded-full;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground/30 rounded-full hover:bg-muted-foreground/50 transition-colors;
  }

  /* Gradient borders */
  .border-gradient {
    border: 1px solid transparent;
    background: 
      linear-gradient(var(--background), var(--background)) padding-box,
      linear-gradient(135deg, hsl(var(--primary)), hsl(var(--accent))) border-box;
  }

  /* Apple aesthetic colors - CopyWorx v2 */
  .bg-apple-gray-bg {
    background-color: #F5F5F7;
  }

  .bg-apple-editor-bg {
    background-color: #2F3542;
  }

  .text-apple-text-dark {
    color: #1D1D1F;
  }

  .border-apple-gray-light {
    border-color: #D2D2D7;
  }

  .border-apple-gray {
    border-color: #86868B;
  }

  .bg-apple-blue {
    background-color: #0071E3;
  }

  .bg-apple-blue-dark {
    background-color: #0062CC;
  }

  .text-apple-blue {
    color: #0071E3;
  }

  .hover\:bg-apple-blue-dark:hover {
    background-color: #0062CC;
  }

  .hover\:bg-apple-gray-bg:hover {
    background-color: #F5F5F7;
  }

  .hover\:border-apple-gray:hover {
    border-color: #86868B;
  }

  .focus\:ring-apple-blue:focus {
    --tw-ring-color: #0071E3;
  }

  /* Editor font family classes - used by TipTap FontFamily extension */
  .font-editor-inter { font-family: var(--font-inter), system-ui, sans-serif; }
  .font-editor-roboto { font-family: var(--font-roboto), system-ui, sans-serif; }
  .font-editor-open-sans { font-family: var(--font-open-sans), system-ui, sans-serif; }
  .font-editor-lato { font-family: var(--font-lato), system-ui, sans-serif; }
  .font-editor-montserrat { font-family: var(--font-montserrat), system-ui, sans-serif; }

  /* Animated gradient for AI generation button */
  .aiworx-gradient-animated {
    background: linear-gradient(90deg, #006EE6, #7A3991, #006EE6);
    background-size: 200% 100%;
    animation: gradient-flow 3s ease-in-out infinite;
  }

  @keyframes gradient-flow {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  /* Brand button - Blue to Purple active state */
  .btn-brand {
    background-color: #006EE6;
    color: white;
    transition: background-color 200ms ease-in-out, transform 200ms ease-in-out;
  }

  .btn-brand:hover:not(:disabled) {
    background-color: #0062CC;
  }

  .btn-brand:active:not(:disabled) {
    background-color: #7A3991;
    transform: scale(0.98);
  }

  .btn-brand:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

/**
 * =============================================================================
 * PRINT / PDF EXPORT STYLES
 * =============================================================================
 * Applied when user clicks "Export PDF" or presses Cmd/Ctrl+P.
 * Browser handles pagination automatically via @page rules.
 * User selects "Save as PDF" in print dialog to export.
 * 
 * CRITICAL: All height/overflow restrictions MUST be reset for multi-page export.
 * The #print-content element wraps the actual TipTap editor content.
 */
@media print {
  /* Page setup */
  @page {
    size: letter;
    margin: 0.75in;
  }

  /* =========================================================================
     STEP 1: Reset html and body
     ========================================================================= */
  html, body {
    height: auto !important;
    width: 100% !important;
    max-height: none !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: visible !important;
    background: white !important;
  }

  /* =========================================================================
     STEP 2: Hide EVERYTHING except the print content
     ========================================================================= */
  [data-print-hide],
  [data-sidebar],
  aside,
  header,
  nav,
  [role="dialog"],
  [data-radix-portal],
  .print-toolbar,
  button {
    display: none !important;
  }

  /* =========================================================================
     STEP 3: Reset ALL parent containers to allow content flow
     Target the layout hierarchy: WorkspaceLayout > main > EditorArea > Paper > Editor
     ========================================================================= */
  
  /* WorkspaceLayout container */
  [data-print-layout] {
    display: block !important;
    position: static !important;
    height: auto !important;
    max-height: none !important;
    min-height: 0 !important;
    overflow: visible !important;
    width: 100% !important;
  }

  /* All descendants of print layout */
  [data-print-layout] *:not([data-print-hide]):not(button):not(aside):not(nav) {
    position: static !important;
    height: auto !important;
    max-height: none !important;
    min-height: 0 !important;
    overflow: visible !important;
    flex: none !important;
  }

  /* Editor outer container */
  [data-print-content] {
    display: block !important;
    position: static !important;
    width: 100% !important;
    height: auto !important;
    max-height: none !important;
    overflow: visible !important;
    padding: 0 !important;
    margin: 0 !important;
    background: white !important;
  }

  /* Editor wrapper - remove padding for print */
  .print-editor-wrapper {
    padding: 0 !important;
    overflow: visible !important;
  }

  /* Zoom container - CRITICAL: remove transform */
  .editor-zoom-container {
    transform: none !important;
    width: 100% !important;
    height: auto !important;
    overflow: visible !important;
  }

  /* =========================================================================
     STEP 4: Style the actual print content
     ========================================================================= */
  #print-content {
    display: block !important;
    position: static !important;
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    max-height: none !important;
    min-height: 0 !important;
    overflow: visible !important;
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    box-shadow: none !important;
    border: none !important;
  }

  /* All content inside print-content must be visible */
  #print-content * {
    overflow: visible !important;
    max-height: none !important;
  }

  /* TipTap editor styling for print */
  .tiptap-editor,
  .tiptap-editor .ProseMirror {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    font-size: 12pt !important;
    line-height: 1.6 !important;
    color: black !important;
    height: auto !important;
    min-height: 0 !important;
    overflow: visible !important;
    background: white !important;
  }

  /* =========================================================================
     STEP 5: Smart page breaks
     ========================================================================= */
  
  /* Headings - avoid orphan headings at bottom of page */
  #print-content h1,
  #print-content h2,
  #print-content h3,
  #print-content h4,
  .tiptap-editor h1,
  .tiptap-editor h2,
  .tiptap-editor h3 {
    page-break-after: avoid;
    break-after: avoid;
    page-break-inside: avoid;
  }

  /* Paragraphs - prevent orphans/widows */
  #print-content p,
  #print-content li,
  .tiptap-editor p,
  .tiptap-editor li {
    orphans: 3;
    widows: 3;
  }

  /* Keep lists together when possible */
  #print-content ul,
  #print-content ol,
  .tiptap-editor ul,
  .tiptap-editor ol {
    page-break-inside: avoid;
  }

  /* Keep blockquotes and code blocks together */
  #print-content blockquote,
  #print-content pre,
  .tiptap-editor blockquote,
  .tiptap-editor pre {
    page-break-inside: avoid;
  }

  /* Links - print as black underlined text */
  .tiptap-editor a {
    color: black !important;
    text-decoration: underline !important;
  }

  /* =========================================================================
     STEP 6: Global cleanup
     ========================================================================= */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
    transition: none !important;
    animation: none !important;
  }
}

